# Web 安全漏洞

#### SQL注入

****

##### SQL注入的原理

> SQL命令通过表单提交到页面请求中，执行SQL命令
>
> 【不区分用户数据和命令】

##### SQL注入的分类

1. 平台层注入
2. 代码层注入

##### SQL注入的原因解析

1. 不当的类型处理
2. 不安全的数据库配置
3. 不合理的查询集处理
4. 不当的错误处理
5. 转义字符处理不合适
6. 多个提交处理不合适

##### SQL注入的危害

- 信息泄露：数据库信息泄露
- 网页篡改：通过数据库修改
- 网站挂马：修改连接
- 安装后门：数据库服务器提供操作系统支持
- 破坏硬盘

#####  SQL注入的 防御方法

1. **预编译**
   - 预编译语句代替语句  【1. 提高可读性 2. 提高性能  3. 只把输入串当作数据处理 缺点：平台支持】
2. **严格的数据类型**
   - 对接收的数据进行类型检查
3. **字符转义**
   - 对特殊的字符串进行转义
4. **存储过程**



#### XSS(Cross SiteScript) 跨站脚本攻击

****

##### XSS的原理

> Web页面中插入恶意的 html标签  或者javascript代码

##### XSS的类型

1. **存储型XSS**
   - XSS攻击数据存储在数据库中
   - 返回到客户端中
   - 客户端未经转义进行渲染
2. **反射型XSS**
   - XSS攻击数据用用户输入
   - 发送回后台  后台未对数据进行过滤
   - 数据防护客户端
   - 浏览器渲染被攻击
3. **DOM-XSS**

##### XSS攻击的危害

- 窃取cookie
- 网络钓鱼
- 结合其他攻击（DDOS CSRF漏洞）

##### XSS的防御方法

- **输入输出的数据都要进行转义**
  - 变量限制  defualt限制
  - 字符串数据对 < > / '  " &等字符进行实体化转义
- **cookie保护**
  - 设置cookie hostoly
  - 不把隐私放在cookie中
  - 尽量采用POST而不是GET提交表单



#### CSRF(Cross-site Request Forgery)跨站点请求伪造

****

##### CSRF的原理

> 网站信任浏览器 用户登录网站
>
> 攻击者诱惑用户点击恶意网站
>
> 诱惑客户端点击B的连接访问正常网站

![è¿éåå¾çæè¿°](https://img-blog.csdn.net/20180415205611934?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNjUyNTI3NQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

##### CSRF的防御方法

1. **验证HTTP Referer字段**
   - referer 字段：HTTP的来源地址
   - 优点： 简单
   - 缺点：1. 隐私暴露  2. 安全依赖浏览器 不可靠
2. **表单中添加token并验证**
   - 主流方法
   - 主要流程：
     - 用户访问表单页面
     - 浏览器生成一个随机数 Token 
     - 表单中附带Token参数
     - 验证Token
3. **检验证码**
   - 影响用户体验
4. **尽量谁用POST 少使用GET**
   - 不能确保 但是能降低风险



#### DDOS分布式拒接服务攻击

****

##### DDOS原理

> 攻击者然网站负载超标 无法提供正常服务

##### 分类

1. **SYN Flood 攻击**
   - 大量伪造源IP 源端口的SYN或者ACK包 
2. **TCP全连接攻击**
   - 避过一般的防火墙
   - 通过许多的僵尸主句建立连接消耗资源
3. **Script脚本攻击**
   - 不断向脚本程序提交查询列表的大量耗费数据的调用

##### DDos的防御方法

- **SYN cookie**   (用cookie来替代等待 )（要等待的ack信息加密后存储 释放连接  接受到ack后比对再建立连接）
- **避免使用NAT 地址转换**  地址转换消耗资源
- **安装防火墙**
- **使用高性能，高宽带的机器**
- **网站静态化或者伪静态**



#### 文件上传漏洞

****

##### 漏洞原理

> 上传了可执行的恶意软件

##### 防御方法

- 文件拓展名服务端白名单
- 文件内容校验
- 上传文件重命名
- 上传文件不可执行
- 单独设置文件服务器的域名

